/summon falling_block ~ ~1 ~ {Block:clay,Time:1,Passengers:[{id:falling_block,Block:redstone_block,Time:1,Passengers:[{id:falling_block,Block:activator_rail,Time:1,Passengers:[{id:commandblock_minecart,Command:gamerule commandBlockOutput false},{id:commandblock_minecart,Command:fill ~ ~-3 ~ ~41 ~-3 ~ chain_command_block 5},{id:commandblock_minecart,Command:setblock ~ ~-3 ~ repeating_command_block 5 1 {auto:1,Command:scoreboard players reset @e[type=item] che_Unstacker}},{id:commandblock_minecart,Command:setblock ~1 ~-3 ~ chain_command_block 13 1 {auto:1,Command:scoreboard players set @e[type=item] che_Unstacker 0 {Item:{id:minecraft:observer,Count:1b}}}},{id:commandblock_minecart,Command:setblock ~2 ~-3 ~ chain_command_block 13 1 {auto:1,Command:stats entity @e[type=item,score_che_Unstacker=0] set AffectedBlocks @e[c=1,type=item] che_Unstacker}},{id:commandblock_minecart,Command:setblock ~3 ~-3 ~ chain_command_block 13 1 {auto:1,Command:execute @e[type=item,score_che_Unstacker=0] ~ ~ ~ detect ~ ~-.1 ~ dropper * testforblock ~ ~-.1 ~ dropper * {Items:[{Slot:3b,id:minecraft:writable_book,Count:1b},{Slot:4b,id:minecraft:heavy_weighted_pressure_plate,Count:1b},{Slot:5b,id:minecraft:writable_book,Count:1b},{Slot:7b,id:minecraft:redstone,Count:1b}]}}},{id:commandblock_minecart,Command:setblock ~4 ~-3 ~ chain_command_block 13 1 {auto:1,Command:execute @e[type=armor_stand,name=che_Unstacker] ~ ~.4 ~ scoreboard players reset @e[type=item,score_che_Unstacker=0,r=1] che_Unstacker}},{id:commandblock_minecart,Command:blockdata ~5 ~-3 ~ {Command:execute @e[type=item,score_che_Unstacker_min=1] ~ ~ ~ summon leash_knot ~ ~-.1 ~ {CustomName:che_Frame}}},{id:commandblock_minecart,Command:setblock ~6 ~-3 ~ chain_command_block 13 1 {auto:1,Command:kill @e[type=item,score_che_Unstacker_min=1]}},{id:commandblock_minecart,Command:setblock ~7 ~-3 ~ chain_command_block 13 1 {auto:1,Command:"execute @e[name=che_Frame,type=leash_knot] ~ ~ ~ blockdata ~ ~ ~ {CustomName:Unstacker,Items:[{Slot:3b,id:book,Count:1b,tag:{UnstackBook:{t:1b},ench:[{id:-1s}],display:{Lore:[\\\"This sets the mode to count!\\\",\\\"WARNING! THIS WILL CHANGE THE LORE OF THE ITEMS THAT PASS ABOVE THE UNSTACKER!\\\",\\\"Place this book in the center to choose this mode!\\\"],LocName:\\\"Count\\\"}}},{Slot:5b,id:book,Count:1b,tag:{UnstackBook:{t:2b},ench:[{id:-1s}],display:{Lore:[\\\"This sets the mode to remove the Unstack!\\\",\\\"WARNING! THIS WILL STRIP ANY ITEM ABOVE IT OF EVERYTHING!\\\",\\\"Place this book in the center to choose this mode!\\\"],LocName:\\\"Clear\\\"}}}]}"}},{id:commandblock_minecart,Command:setblock ~8 ~-3 ~ chain_command_block 13 1 {auto:1,Command:execute @e[name=che_Frame,type=leash_knot] ~ ~ ~ summon armor_stand ~ ~-.4 ~ {CustomName:che_Unstacker,ShowArms:1b,NoGravity:1b,Small:1b,ArmorItems:[{},{},{},{Count:1b,id:observer}],Invulnerable:1b,Invisible:1b,DisabledSlots:1973790}}},{id:commandblock_minecart,Command:setblock ~9 ~-3 ~ chain_command_block 13 1 {auto:1,Command:execute @e[type=armor_stand,name=che_Unstacker] ~ ~ ~ playsound entity.shulker.close ambient @a ~ ~ ~ 1 0.8 1}},{id:commandblock_minecart,Command:setblock ~10 ~-3 ~ chain_command_block 13 1 {auto:1,Command:kill @e[name=che_Frame,type=leash_knot]}},{id:commandblock_minecart,Command:blockdata ~11 ~-3 ~ {Command:scoreboard players tag @e[type=armor_stand,name=che_Unstacker] add Unstacker_broken}},{id:commandblock_minecart,Command:blockdata ~12 ~-3 ~ {Command:execute @e[type=armor_stand,name=che_Unstacker] ~ ~ ~ detect ~ ~ ~ dropper * scoreboard players tag @e[type=armor_stand,c=1] remove Unstacker_broken}},{id:commandblock_minecart,Command:blockdata ~13 ~-3 ~ {Command:execute @e[type=armor_stand,name=che_Unstacker,tag=Unstacker_broken] ~ ~ ~ summon item ~ ~.6 ~ {Item:{id:redstone,Count:1b},Passengers:[{id:item,Item:{id:heavy_weighted_pressure_plate,Count:1b}},{id:item,Item:{id:writable_book,Count:2b}},{id:item,Item:{id:observer,Count:1b}}]}}},{id:commandblock_minecart,Command:setblock ~14 ~-3 ~ chain_command_block 13 1 {auto:1,Command:execute @e[type=armor_stand,name=che_Unstacker,tag=Unstacker_broken] ~ ~ ~ particle iconcrack ~ ~1 ~ .1 .25 .1 .05 30 normal @a 218 0}},{id:commandblock_minecart,Command:setblock ~15 ~-3 ~ chain_command_block 13 1 {auto:1,Command:scoreboard players tag @e[type=item] add che_Removebook {Item:{tag:{UnstackBook:{}}}}}},{id:commandblock_minecart,Command:setblock ~16 ~-3 ~ chain_command_block 13 1 {auto:1,Command:execute @e[type=armor_stand,name=che_Unstacker,tag=Unstacker_broken] ~ ~ ~ kill @e[type=item,tag=che_Removebook,r=2]}},{id:commandblock_minecart,Command:blockdata ~17 ~-3 ~ {Command:kill @e[type=armor_stand,name=che_Unstacker,tag=Unstacker_broken]}},{id:commandblock_minecart,Command:blockdata ~18 ~-3 ~ {Command:scoreboard players set @e[type=armor_stand,name=che_Unstacker] che_UnstackerM 0}},{id:commandblock_minecart,Command:setblock ~19 ~-3 ~ chain_command_block 13 1 {auto:1,Command:scoreboard players set @e[type=armor_stand,name=che_Unstacker] che_UnstackerM 1 {HandItems:[{tag:{UnstackBook:{t:1b}}}]}}},{id:commandblock_minecart,Command:blockdata ~20 ~-3 ~ {Command:scoreboard players set @e[type=armor_stand,name=che_Unstacker] che_UnstackerM 2 {HandItems:[{tag:{UnstackBook:{t:2b}}}]}}},{id:commandblock_minecart,Command:blockdata ~21 ~-3 ~ {Command:execute @e[name=che_Unstacker,type=armor_stand,score_che_UnstackerM_min=1,score_che_UnstackerM=1] ~ ~ ~ particle smoke ~ ~1 ~ 0 .1 0 0 3 force @a}},{id:commandblock_minecart,Command:blockdata ~22 ~-3 ~ {Command:execute @e[name=che_Unstacker,type=armor_stand,score_che_UnstackerM_min=2,score_che_UnstackerM=2] ~ ~ ~ particle portal ~ ~.5 ~ 0 .1 0 0 3 force @a}},{id:commandblock_minecart,Command:blockdata ~23 ~-3 ~ {Command:execute @e[score_che_UnstackerM_min=2,score_che_UnstackerM=2,type=armor_stand] ~ ~1 ~ entitydata @e[type=item,dx=0] {Item:{tag:}}}},{id:commandblock_minecart,Command:blockdata ~24 ~-3 ~ {Command:execute @e[type=armor_stand,name=che_Unstacker,score_che_UnstackerM_min=1,score_che_UnstackerM=1] ~ ~1 ~ scoreboard players tag @e[type=item,dx=0,c=1,tag=!UnstackerTagged] add SingleStackFound {Item:{Count:1b}}}},{id:commandblock_minecart,Command:setblock ~25 ~-3 ~ chain_command_block 13 1 {auto:1,Command:blockdata ~2 ~ ~ {auto:1}}},{id:commandblock_minecart,Command:setblock ~26 ~-3 ~ chain_command_block 13 1 {auto:1,Command:blockdata ~1 ~ ~ {auto:0}}},{id:commandblock_minecart,Command:setblock ~27 ~-3 ~ command_block 5 1 {Command:execute @e[type=item,tag=SingleStackFound] ~ ~-1 ~ scoreboard players add @e[type=armor_stand,name=che_Unstacker,c=1,r=2] che_UnstackCount 1}},{id:commandblock_minecart,Command:blockdata ~28 ~-3 ~ {Command:execute @e[type=item,tag=SingleStackFound] ~ ~ ~ scoreboard players operation @e[type=item,c=1] che_UnstackCount = @e[type=armor_stand,score_che_UnstackCount_min=1,score_che_UnstackCount=9,c=1,r=2] che_UnstackCount}},{id:commandblock_minecart,Command:blockdata ~29 ~-3 ~ {Command:scoreboard players tag @e[type=item,score_che_UnstackCount_min=1,score_che_UnstackCount=9,tag=SingleStackFound] add UnstackerTagged}},{id:commandblock_minecart,Command:blockdata ~30 ~-3 ~ {Command:scoreboard players tag @e[type=item,tag=UnstackerTagged] remove SingleStackFound}},{id:commandblock_minecart,Command:blockdata ~31 ~-3 ~ {Command:"entitydata @e[type=item,score_che_UnstackCount_min=1,score_che_UnstackCount=1] {Item:{tag:{display:{Lore:[\\\"Unstacked (1)\\\"]}}}}"}},{id:commandblock_minecart,Command:blockdata ~32 ~-3 ~ {Command:"entitydata @e[type=item,score_che_UnstackCount_min=2,score_che_UnstackCount=2] {Item:{tag:{display:{Lore:[\\\"Unstacked (2)\\\"]}}}}"}},{id:commandblock_minecart,Command:blockdata ~33 ~-3 ~ {Command:"entitydata @e[type=item,score_che_UnstackCount_min=3,score_che_UnstackCount=3] {Item:{tag:{display:{Lore:[\\\"Unstacked (3)\\\"]}}}}"}},{id:commandblock_minecart,Command:blockdata ~34 ~-3 ~ {Command:"entitydata @e[type=item,score_che_UnstackCount_min=4,score_che_UnstackCount=4] {Item:{tag:{display:{Lore:[\\\"Unstacked (4)\\\"]}}}}"}},{id:commandblock_minecart,Command:blockdata ~35 ~-3 ~ {Command:"entitydata @e[type=item,score_che_UnstackCount_min=5,score_che_UnstackCount=5] {Item:{tag:{display:{Lore:[\\\"Unstacked (5)\\\"]}}}}"}},{id:commandblock_minecart,Command:blockdata ~36 ~-3 ~ {Command:"entitydata @e[type=item,score_che_UnstackCount_min=6,score_che_UnstackCount=6] {Item:{tag:{display:{Lore:[\\\"Unstacked (6)\\\"]}}}}"}},{id:commandblock_minecart,Command:blockdata ~37 ~-3 ~ {Command:"entitydata @e[type=item,score_che_UnstackCount_min=7,score_che_UnstackCount=7] {Item:{tag:{display:{Lore:[\\\"Unstacked (7)\\\"]}}}}"}},{id:commandblock_minecart,Command:blockdata ~38 ~-3 ~ {Command:"entitydata @e[type=item,score_che_UnstackCount_min=8,score_che_UnstackCount=8] {Item:{tag:{display:{Lore:[\\\"Unstacked (8)\\\"]}}}}"}},{id:commandblock_minecart,Command:blockdata ~39 ~-3 ~ {Command:"entitydata @e[type=item,score_che_UnstackCount_min=9,score_che_UnstackCount=9] {Item:{tag:{display:{Lore:[\\\"Unstacked (9)\\\"]}}}}"}},{id:commandblock_minecart,Command:blockdata ~40 ~-3 ~ {Command:scoreboard players set @e[type=armor_stand,name=che_Unstacker,score_che_UnstackCount_min=9] che_UnstackCount 0}},{id:commandblock_minecart,Command:blockdata ~41 ~-3 ~ {Command:scoreboard players set @e[type=item,score_che_UnstackCount_min=1] che_UnstackCount 0}},{id:commandblock_minecart,Command:setblock ~ ~1 ~ command_block 0 0 {auto:1,Command:/fill ~ ~-3 ~ ~ ~ ~ air}},{id:commandblock_minecart,Command:kill @e[type=commandblock_minecart,r=1]}]}]}]}
